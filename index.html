<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>List Dropbox Files</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    a { display: block; margin: 5px 0; color: blue; text-decoration: underline; }
  </style>
</head>
<body>
  <h2>Dropbox File List</h2>
  <div id="fileList">Loading...</div>

  <script>
    const sheetURL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vS4LebC36zQ_LbyRlp5qw3EOiwAx5FBR5gdyst-qNVwjQL1d9DOP6KI5qZ4r-9vrn6Hg09s4LLukTyx/pub?gid=0&single=true&output=csv";

    fetch(sheetURL)
      .then(response => response.text())
      .then(csvText => {
        const data = Papa.parse(csvText, { header: true }).data;
        const container = document.getElementById("fileList");

        // Cek kalau sheet kosong
        if(!data || data.length === 0) {
          container.innerText = "No files found.";
          return;
        }

        // Tampilkan file sebagai link
        container.innerHTML = data.map(item => {
          if(item.file_link) { // pastikan ada link
            return `<a href="${item.file_link}" target="_blank">${item.filename || "Unnamed File"}</a>`;
          } else {
            return "";
          }
        }).join("");
      })
      .catch(err => {
        console.error("Error fetching sheet:", err);
        document.getElementById("fileList").innerText = "Failed to load files.";
      });
  </script>
</body>
</html>
